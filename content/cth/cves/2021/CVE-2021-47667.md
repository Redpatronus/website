---
title: CVE-2021-47667
date: 2025-04-05 05:11:43
tags:
  - CVE-2021-47667
excludeSearch: false
width: wide
---

### Vulnerability: OS Command Injection in ZendTo

**Description:**

Unauthenticated remote attackers can execute arbitrary operating system commands due to insufficient input sanitization in the `tmp_name` parameter when processing file drop-off requests.  Specifically, shell metacharacters are not properly escaped or filtered within the `lib/NSSDropoff.php` script when handling a POST request to the `/dropoff` endpoint.

**Severity:**

Critical (CVSS v3 score of 10.0) due to the potential for unauthenticated remote code execution.

**Known Exploit:**

An attacker can craft a malicious POST request to the `/dropoff` endpoint, including shell metacharacters (e.g., `;`, `|`, `&&`) within the `tmp_name` parameter. When the ZendTo application processes this request, it will execute the embedded commands on the server with the privileges of the web server user. This allows the attacker to potentially gain control of the server, read sensitive data, or launch further attacks.

**Remediation / Mitigation Strategy:**

1.  **Upgrade ZendTo:**  The primary solution is to upgrade to ZendTo version 6.10-7 or later.  These versions contain the necessary fixes to properly sanitize the `tmp_name` parameter.

2.  **Input Sanitization:** If upgrading is not immediately possible, implement strict input validation and sanitization on the `tmp_name` parameter in `lib/NSSDropoff.php`. Specifically:
    *   **Whitelist Approved Characters:** Only allow alphanumeric characters, underscores, periods, and hyphens in the `tmp_name` value. Reject any requests containing shell metacharacters.
    *   **Escape Shell Metacharacters:** If you must allow a broader range of characters, properly escape all shell metacharacters before passing the `tmp_name` value to any shell commands.  Use functions appropriate for your operating system (e.g., `escapeshellarg()` in PHP).

3.  **Web Application Firewall (WAF):** Deploy a web application firewall (WAF) with rules that can detect and block requests containing shell metacharacters in the `tmp_name` parameter of POST requests to the `/dropoff` endpoint. This provides an additional layer of protection even if the application-level fix is not yet fully deployed.

4.  **Network Segmentation:** Isolate the ZendTo server within a segmented network to limit the potential damage if an attacker successfully exploits the vulnerability. Ensure that the server has only the necessary network access to perform its intended functions.

5.  **Monitor Logs:**  Continuously monitor web server logs and intrusion detection system (IDS) alerts for suspicious activity related to the `/dropoff` endpoint, such as failed login attempts, unusual URL parameters, or attempts to execute shell commands.

6.  **Regular Security Audits:**  Conduct regular security audits and penetration testing to identify and address any potential vulnerabilities in the ZendTo application and its infrastructure.

7.  **Principle of Least Privilege:** Ensure that the web server user has only the minimal necessary privileges. This limits the potential impact if an attacker gains control of the server.

### Assigner
- **MITRE** <cve@mitre.org>

### Date
- **Published Date**: 2025-04-05 00:00:00
- **Updated Date**: 2025-04-05 05:11:43

### More Details
[CVE-2021-47667](https://www.cvedetails.com/cve/CVE-2021-47667)
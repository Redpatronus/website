---
title: CVE-2025-27148
date: 2025-02-25 21:15:18
tags:
  - CVE-2025-27148
excludeSearch: false
width: wide
---

## CVE-2025-27148: Local Privilege Escalation in Gradle via Native-Platform Library

**Vulnerability Description:**

The `net.rubygrapefruit:native-platform` library, used by Gradle, is vulnerable to a local privilege escalation on Unix-like systems.  Due to insufficient security measures during the initialization of the native library, specifically when `Native.get(Class<>)` is called without proper initialization using `Native.init(File)`, the library may default to using the system temporary directory (`/tmp`).  This directory, by default, often has open permissions, allowing multiple users to create and delete files within it. An attacker can exploit this by rapidly deleting and recreating files in the temporary directory, potentially leading to the replacement of legitimate files with malicious ones used by Gradle during its execution.  This can then escalate to the attacker gaining the privileges of the user running the Gradle build.

**Severity:**

*   **CVSS Score:** 8.8 (High)
*   **CVSS Vector:** AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
*   **Severity Rating:** High

**Known Exploit:**

An attacker with local access to the system can exploit this vulnerability by:

1.  Identifying a Gradle build process running on a vulnerable version of the `native-platform` library.
2.  Monitoring the system temporary directory (`/tmp` by default, or wherever `java.io.tmpdir` points to) for temporary files created by Gradle.
3.  Rapidly deleting and recreating these temporary files, attempting to replace them with malicious files that the Gradle build process will then execute with the permissions of the user running the build.
4.  Achieving arbitrary code execution with the privileges of the user running the Gradle build, leading to privilege escalation.

**Affected Versions:**

*   `net.rubygrapefruit:native-platform` versions prior to 0.22-milestone-28.
*   Gradle version 8.12 *only*. (This specific version had codepaths that defaulted to using the system temporary directory during native library initialization).

**Unaffected Versions:**

*   `net.rubygrapefruit:native-platform` version 0.22-milestone-28 and later.
*   Gradle versions other than 8.12, *except* if they use vulnerable versions of the native-platform library.
*   Gradle versions 8.12.1 and later.
*   Gradle version 8.13 and later.
*   Systems where the sticky bit is set on the system temporary directory (e.g., `/tmp`), or where the `/tmp` directory is mounted with the `noexec` option.
*   Windows and modern versions of macOS systems.

**Remediation / Mitigation Strategy:**

The following steps should be taken to mitigate this vulnerability:

1.  **Upgrade `net.rubygrapefruit:native-platform` library:** Ensure that your Gradle projects use version 0.22-milestone-28 or later of the `net.rubygrapefruit:native-platform` library. This version includes a fix that mandates initialization and avoids the use of the system temporary directory unless explicitly specified. Review Gradle dependencies and update accordingly.

2.  **Upgrade Gradle:** If you are using Gradle 8.12, upgrade to version 8.12.1 or later. Gradle 8.13 also upgrades to a non-vulnerable version of the native library.

3.  **Proper Initialization:** For affected versions of `net.rubygrapefruit:native-platform`, ensure proper initialization using `Native.init(File)` with a safe location that is not world-writable.  This prevents the library from defaulting to the system temporary directory.  Review the code and modify the Gradle build scripts to ensure the `Native` class is initialized with a safe location.

4.  **Secure Temporary Directory:** Implement one or more of the following security measures on the system:

    *   **Set Sticky Bit:** On Unix-like systems, set the sticky bit on the system temporary directory (e.g., `/tmp`). This restricts file deletion to the owner of the file or the root user, preventing unauthorized deletion by other users. Use the command: `chmod +t /tmp`
    *   **Mount `/tmp` with `noexec`:**  Mount the system temporary directory with the `noexec` option to prevent the execution of files from the temporary directory.  This can be achieved by modifying the `/etc/fstab` file.
    *   **Restrict Permissions on `/tmp`:**  While not recommended as a primary solution, restricting permissions on `/tmp` can reduce the attack surface.

5.  **Change the Java Temporary Directory:** If you cannot modify the system temporary directory's permissions, change the Java temporary directory by setting the system property `java.io.tmpdir`.  The new directory must have permissions restricted to the build user only.  You can set this property when invoking Gradle:

        gradle -Djava.io.tmpdir=/path/to/secure/tmp/dir <tasks>
    
    Replace `/path/to/secure/tmp/dir` with a directory that only the build user can access.  Create this directory beforehand and ensure it has appropriate permissions (e.g., `chmod 700 /path/to/secure/tmp/dir`).

6.  **Regular Security Audits:**  Conduct regular security audits of your Gradle projects and dependencies to identify and address potential vulnerabilities proactively.

7.  **Principle of Least Privilege:**  Ensure that the user account used to run Gradle builds has the least necessary privileges to perform its tasks. Avoid running builds as root or administrative accounts.

**Monitoring and Detection:**

*   Monitor the system temporary directory (or the specified `java.io.tmpdir`) for unexpected file creations, deletions, or modifications during Gradle builds.
*   Implement intrusion detection systems (IDS) and intrusion prevention systems (IPS) to detect suspicious activity related to temporary file manipulation.
*   Review Gradle build logs for any errors or warnings related to native library initialization or file access issues.

By implementing these remediation and mitigation steps, you can significantly reduce the risk of exploitation of CVE-2025-27148 and protect your Gradle build environments from local privilege escalation attacks.

### Assigner
- **GitHub, Inc.** <security-advisories@github.com>

### Date
- **Published Date**: 2025-02-25 20:13:52
- **Updated Date**: 2025-02-25 21:15:18

### More Details
[CVE-2025-27148](https://www.cvedetails.com/cve/CVE-2025-27148)